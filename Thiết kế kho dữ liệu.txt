CREATE TABLE [DIM_PATIENT] (
	PATIENT_ID INT IDENTITY(1,1) PRIMARY KEY,
	AGE INT NOT NULL,
	GENDER NVARCHAR(255) NOT NULL,
    COUNTRY_NAME NVARCHAR(255) NOT NULL,
    SMOKING_STATUS NVARCHAR(255) NOT NULL,
    FAMILY_HISTORY NVARCHAR(255) NOT NULL,
    HYPERTENSION NVARCHAR(255) NOT NULL,
    ASTHMA NVARCHAR(255) NOT NULL,
    CIRRHOSIS NVARCHAR(255) NOT NULL,
    OTHER_CANCER NVARCHAR(255) NOT NULL,
    BMI_CATEGORY NVARCHAR(255) NOT NULL,
    CHOLESTEROL_CATEGORY NVARCHAR(255) NOT NULL
);


CREATE TABLE [DIM_CANCER_STAGE] (
    STAGE_ID INT IDENTITY(1,1) PRIMARY KEY,
    STAGE_NAME NVARCHAR(255) NOT NULL
);


CREATE TABLE [DIM_TREATMENT] (
    TREATMENT_ID INT IDENTITY(1,1) PRIMARY KEY,
    TREATMENT_TYPE NVARCHAR(255) NOT NULL
);


CREATE TABLE [DIM_DATE] (
    DATE_ID INT PRIMARY KEY,
    FULL_DATE DATE NOT NULL,
    DAY INT NOT NULL,
    MONTH INT NOT NULL,
    QUARTER INT NOT NULL,
    YEAR INT NOT NULL,
    DAY_OF_WEEK NVARCHAR(255),
    IS_WEEKEND CHAR(3) NOT NULL
);


CREATE TABLE [FACT_DIAGNOSIS] (
    FACT_DIAGNOSIS_ID INT IDENTITY(1,1) PRIMARY KEY,
    PATIENT_ID INT NOT NULL,
    DIAGNOSIS_DATE_ID INT NOT NULL,
    STAGE_ID INT NOT NULL,
    BMI DECIMAL(5,2) NOT NULL,
    CHOLESTEROL_LEVEL INT NOT NULL,
);


CREATE TABLE [FACT_TREATMENT_OUTCOME] (
    FACT_TREATMENT_FACT_ID INT IDENTITY(1,1) PRIMARY KEY,
    PATIENT_ID INT NOT NULL,
    TREATMENT_ID INT NOT NULL,
    START_DATE_ID INT NOT NULL,
    END_DATE_ID INT NOT NULL,
    TREATMENT_DURATION_DAYS INT NOT NULL,
    IS_SURVIVED INT NOT NULL
);

ISNULL((DT_I4)[bmi]) ? "Unknown" : ( (DT_I4)[bmi] < 18.5) ? "Underweight" : ( (DT_I4)[bmi] < 25) ? "Normal" : ( (DT_I4)[bmi] < 30) ? "Overweight" : "Obese"

ISNULL ((DT_I4)[cholesterol_level]) ? "Unknown" : ((DT_I4)[cholesterol_level] < 200) ? "Desirable" : ((DT_I4)[cholesterol_level] <= 239) ? "Borderline High" : "High"

